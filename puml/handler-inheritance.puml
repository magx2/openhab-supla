@startuml
skinparam classAttributeIconSize 0
skinparam linetype ortho
skinparam nodesep 60
skinparam ranksep 60
hide empty members

' Keep the most-shared abstractions visually at the top
top to bottom direction

skinparam class {
BackgroundColor<<OpenHAB>> HoneyDew
BackgroundColor<<SuplaCloud>> Cornsilk
BackgroundColor<<SuplaServer>> MistyRose
BackgroundColor<<SuplaHandler>> Motivation
BackgroundColor<<SuplaCommon>> GreenYellow
}

' Anchor heavily used OpenHAB and Supla abstractions on the top rank
interface ThingHandler <<OpenHAB>>
interface BridgeHandler <<OpenHAB>>
abstract class BaseThingHandler <<OpenHAB>>
abstract class BaseBridgeHandler <<OpenHAB>>

abstract class AbstractDeviceHandler <<SuplaCommon>>
abstract class ServerAbstractDeviceHandler <<SuplaServer>>

interface HandleCommand <<SuplaServer>>
interface SuplaDevice <<SuplaServer>>
interface SuplaThing <<SuplaServer>>
interface SuplaThingRegistry <<SuplaServer>>
interface SuplaBridge <<SuplaServer>>

class GatewayDeviceHandler <<SuplaHandler>>
class SingleDeviceHandler <<SuplaHandler>>
class SubDeviceHandler <<SuplaHandler>>
class ServerBridgeHandler <<SuplaHandler>>

class CloudBridgeHandler <<SuplaCloud>>
class CloudDeviceHandler <<SuplaCloud>>

' OpenHAB core relationships
ThingHandler <|.. BaseThingHandler
ThingHandler <|-- BridgeHandler
BridgeHandler <|.. BaseBridgeHandler

' Device handler relationships
BaseThingHandler <|-- AbstractDeviceHandler
AbstractDeviceHandler <|-- ServerAbstractDeviceHandler
AbstractDeviceHandler <|-- SubDeviceHandler
AbstractDeviceHandler <|-- CloudDeviceHandler
ServerAbstractDeviceHandler <|-- GatewayDeviceHandler
ServerAbstractDeviceHandler <|-- SingleDeviceHandler

' Supla trait implementations (device side)
HandleCommand <|.. AbstractDeviceHandler
HandleCommand <|-- SuplaDevice
SuplaDevice <|.. SubDeviceHandler
SuplaDevice <|.. SingleDeviceHandler
SuplaDevice <|.. GatewayDeviceHandler
SuplaThing <|.. ServerAbstractDeviceHandler

' Bridge handler relationships
BaseBridgeHandler <|-- CloudBridgeHandler
BaseBridgeHandler <|-- ServerBridgeHandler
BridgeHandler <|-- SuplaBridge
SuplaBridge <|.. GatewayDeviceHandler
SuplaBridge <|.left. ServerBridgeHandler
SuplaThingRegistry <|.. ServerBridgeHandler
@enduml
